var Fireworks;!function(t){var i=function(){function t(t,i,n,e){void 0===t&&(t=5),void 0===i&&(i=.1),void 0===n&&(n=20),void 0===e&&(e=100),this.percentIncrement=t,this.maxBlastRad=i,this.flameInQuater=n,this.animateCallRate=1e3/e}return t}();t.Config=i;var n=function(){function t(t,i,n){this.mouseDown=!1,this.isAnimActive=!1,this.canvas=t,this.factor=new o(0,0),this.context=this.canvas.getContext("2d"),this.updateCanvasAndFactor(),this.config=i,this.flamePointFactory=new h(i),this.flamePaths=[],this.callbackOnEmpty=n,this.addListners()}return t.prototype.reset=function(){this.flamePaths=[],this.context.fillStyle="rgba(0,0,0,1)",this.context.fillRect(0,0,this.factor.x,this.factor.y)},t.prototype.addFlameBlasts=function(t,i){var n=this;void 0===i&&(i=!1),(e=this.flamePaths).push.apply(e,t.map(function(t){return n.flamePointFactory.getPreBlastFlamePoint(t.divide(n.factor),i)})),this.isAnimActive||(this.animateRequester(),this.isAnimActive=!0);var e},t.prototype.updateCanvasAndFactor=function(){this.factor.x=this.canvas.clientWidth,this.factor.y=this.canvas.clientHeight,this.canvas.width=this.factor.x,this.canvas.height=this.factor.y,this.shadeCanvas()},t.prototype.addListners=function(){var t=this;window.onresize=function(i){t.updateCanvasAndFactor()}},t.prototype.animateRequester=function(){var t=this;this.flamePaths.length?setTimeout(function(){requestAnimationFrame(function(){t.animate()})},this.config.animateCallRate):(this.isAnimActive=!1,function(t){t()}(this.callbackOnEmpty))},t.prototype.animate=function(){var t=this,i=[];this.flamePaths=this.flamePaths.filter(function(t){return!(t.completion>=100&&(t.stage==e.preBlast&&i.push(t),1))}),(n=this.flamePaths).push.apply(n,i.reduce(function(i,n){return i.push.apply(i,t.flamePointFactory.getPostBlastFlamePoints(n.path.end,n.isLiteBlast)),i},[])),this.drawOnCanvas(),this.animateRequester();var n},t.prototype.shadeCanvas=function(){this.context.fillStyle="rgba(0,0,0,0.2)",this.context.fillRect(0,0,this.factor.x,this.factor.y)},t.prototype.drawOnCanvas=function(){var t=this;this.shadeCanvas(),this.flamePaths.forEach(function(i){var n=i.getNextPoint().multiple(t.factor),o=i.getTrailEndPoint().multiple(t.factor);t.context.beginPath(),t.context.moveTo(n.x,n.y),t.context.lineTo(o.x,o.y),i.stage==e.preBlast?t.context.strokeStyle=i.color.toString():(i.completion<75?0:i.completion/100,t.context.strokeStyle=i.color.toString(i.completion/100)),t.context.stroke()})},t}();t.App=n;var e;!function(t){t[t.preBlast=0]="preBlast",t[t.postBlast=1]="postBlast"}(e||(e={}));var o=function(){function t(t,i){this.x=t,this.y=i}return t.prototype.diff=function(i){return new t(i.x-this.x,i.y-this.y)},t.prototype.add=function(i){return new t(this.x+i.x,this.y+i.y)},t.prototype.multiple=function(i){return new t(this.x*i.x,this.y*i.y)},t.prototype.divide=function(i){return new t(this.x/i.x,this.y/i.y)},t.prototype.getFactoredPoint=function(i,n){return new t(i.x+n*this.x,i.y+n*this.y)},t}();t.Point=o;var s=function(){function t(t,i){this.start=t,this.end=i,this.diff=this.start.diff(i)}return t.prototype.xyAtPercentage=function(t){return this.diff.getFactoredPoint(this.start,t/100)},t}(),a=function(){function t(t,i,n,e){void 0===e&&(e=!1),this.path=t,this.stage=i,this.config=n,this.isLiteBlast=e,this.completion=0,this.color=new r}return t.prototype.getNextPoint=function(){var t=this.config.percentIncrement*(1-this.completion/100);return this.completion+=t<.4?.4:t,this.path.xyAtPercentage(this.completion)},t.prototype.getTrailEndPoint=function(t){return void 0===t&&(t=-4),this.path.xyAtPercentage(this.completion+t)},t}(),r=function(){function t(i){void 0===i&&(i=!1),this.isRGB=i,this.isRGB?(this.r=this.randomNoInRange(0,255),this.g=this.randomNoInRange(0,255),this.b=this.randomNoInRange(0,255),this.a=this.randomNoInRange(0,1)):(t.hue+=.5,this.h=this.randomNoInRange(t.hue-20,t.hue+20),this.s=100,this.l=this.randomNoInRange(50,70))}return t.prototype.randomNoInRange=function(t,i){return Math.round(Math.random()*(i-t)+t)},t.prototype.toString=function(t){return void 0===t&&(t=0),this.isRGB?"rgba("+this.r+","+this.g+","+this.b+","+this.a*(1-t)+")":"hsl("+this.h+","+this.s+"%,"+this.l*(1-t)+"%)"},t.hue=100,t}(),h=function(){function t(t){this.originPoint=new o(.5,1),this.config=t,this.blastCircle=this.initBlastRadiusForConfig(this.config.maxBlastRad,this.config.flameInQuater),this.liteBlastCircle=this.initBlastRadiusForConfig(this.config.maxBlastRad/2,Math.round(this.config.flameInQuater/10))}return t.prototype.getPreBlastFlamePoint=function(t,i){return void 0===i&&(i=!1),new a(new s(this.originPoint,t),e.preBlast,this.config,i)},t.prototype.getPostBlastFlamePoints=function(t,i){var n=this;void 0===i&&(i=!1);var o=[];return o=i?this.liteBlastCircle:this.blastCircle,o.map(function(o){return new a(new s(t,o.getFactoredPoint(t,Math.random())),e.postBlast,n.config,i)})},t.prototype.initBlastRadiusForConfig=function(t,i){for(var n=i*i,e=t/i,s=[],a=0;a<=i;a++){var r=a/i*t,h=e*Math.sqrt(n-a*a);s.push(new o(r,h),new o((-r),h),new o(r,(-h)),new o((-r),(-h)))}return s},t}()}(Fireworks||(Fireworks={}));